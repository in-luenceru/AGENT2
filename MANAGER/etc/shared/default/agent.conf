<!--
  Shared Agent Configuration - Network File System Monitoring
  This configuration will be pushed to all agents
  Updated: 2025-09-11
-->

<agent_config>
  <syscheck>
    <disabled>no</disabled>
    <frequency>43200</frequency>
    <scan_on_start>yes</scan_on_start>
    
    <!-- Network mount points monitoring -->
    <directories realtime="yes">/mnt</directories>
    <directories realtime="yes">/media</directories>
    <directories>/proc/mounts</directories>
    
    <!-- Monitor NFS related directories -->
    <directories>/var/lib/nfs</directories>
    <directories>/etc/exports</directories>
    
    <!-- CIFS/SMB monitoring -->
    <directories>/etc/samba</directories>
  </syscheck>
  
  <localfile>
    <log_format>command</log_format>
    <command>mount | grep -E "(nfs|cifs|smb|fuse)" || echo "No network mounts"</command>
    <frequency>300</frequency>
  </localfile>
  
  <localfile>
    <log_format>command</log_format>
    <command>ss -tulpn | grep -E ":(2049|445|139|111)" || echo "No NFS/SMB ports"</command>
    <frequency>600</frequency>
  </localfile>
  
  <wodle name="syscollector">
    <disabled>no</disabled>
    <interval>1h</interval>
    <network>yes</network>
    <processes>yes</processes>
    <ports all="no">yes</ports>
  </wodle>
</agent_config>
