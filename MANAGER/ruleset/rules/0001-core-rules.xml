<!--
  Core Security Rules for Network File Systems
  Author: Wazuh Agent Security Enhancement  
  Updated: 2025-09-11
-->

<group name="syslog,network_security,">

  <!-- Base syslog rule -->
  <rule id="1002" level="2">
    <decoded_as>syslog</decoded_as>
    <description>Generic syslog message</description>
  </rule>

  <!-- File integrity monitoring base rule -->
  <rule id="550" level="7">
    <category>ossec</category>
    <decoded_as>syscheck_integrity_changed</decoded_as>
    <description>File integrity checksum changed</description>
    <group>syscheck,</group>
  </rule>

  <!-- Network service events -->
  <rule id="2900" level="5">
    <if_sid>1002</if_sid>
    <match>nfsd|rpc.nfsd|rpc.mountd|rpc.statd</match>
    <description>NFS daemon event</description>
    <group>nfs,service,</group>
  </rule>

  <rule id="2901" level="5">
    <if_sid>1002</if_sid>
    <match>smbd|nmbd|winbindd</match>
    <description>Samba daemon event</description>
    <group>samba,smb,service,</group>
  </rule>

  <!-- Mount/Umount events -->
  <rule id="2910" level="3">
    <if_sid>1002</if_sid>
    <regex>kernel:.*mounted filesystem</regex>
    <description>File system mounted</description>
    <group>mount,filesystem,</group>
  </rule>

  <rule id="2911" level="3">
    <if_sid>1002</if_sid>
    <regex>kernel:.*unmounting filesystem</regex>
    <description>File system unmounted</description>
    <group>umount,filesystem,</group>
  </rule>

  <!-- Authentication failures -->
  <rule id="5700" level="8">
    <if_sid>1002</if_sid>
    <match>authentication failure</match>
    <description>Authentication failure</description>
    <group>authentication_failure,</group>
  </rule>

  <!-- Network connection rules -->
  <rule id="3300" level="3">
    <if_sid>1002</if_sid>
    <regex>kernel:.*TCP.*SYN</regex>
    <description>TCP connection attempt</description>
    <group>connection,tcp,</group>
  </rule>

</group>
