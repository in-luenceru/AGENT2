#!/bin/bash
# Mock File Integrity Monitor Daemon for Testing

# Ensure PID directory exists
WAZUH_HOME="${WAZUH_HOME:-$(dirname $(dirname $(realpath $0)))}"
PID_DIR="$WAZUH_HOME/var/run"
mkdir -p "$PID_DIR"

echo "[$(date)] monitor-syscheckd: Mock file integrity monitor started"
echo "[$(date)] monitor-syscheckd: Scanning directories for changes..."

# Create PID file
echo $$ > "$PID_DIR/monitor-syscheckd.pid"

# Mock syscheck behavior
while true; do
    sleep 300
    echo "[$(date)] monitor-syscheckd: File integrity scan completed"
    echo "[$(date)] monitor-syscheckd: Monitoring /etc, /bin, /sbin, /usr/bin, /usr/sbin"
    sleep 300
done