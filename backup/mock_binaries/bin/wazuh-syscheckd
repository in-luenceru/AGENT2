#!/bin/bash
# Mock Wazuh System Check Daemon for Testing

echo "[$(date)] wazuh-syscheckd: Mock file integrity monitor started"
echo "[$(date)] wazuh-syscheckd: Scanning directories for changes..."

# Create PID file
echo $$ > ../var/run/wazuh-syscheckd.pid

# Monitor file changes
while true; do
    # Check for new files in /tmp
    if find /tmp -name "*wazuh*test*" -newer ../var/run/wazuh-syscheckd.pid 2>/dev/null | grep -q .; then
        echo "[$(date)] wazuh-syscheckd: ALERT - File integrity change detected in /tmp"
    fi
    
    sleep 15
done
