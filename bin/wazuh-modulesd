#!/bin/bash
# Mock Wazuh Modules Daemon for Testing

echo "[$(date)] wazuh-modulesd: Mock modules daemon started"  
echo "[$(date)] wazuh-modulesd: Loading vulnerability scanner..."
echo "[$(date)] wazuh-modulesd: Loading syscollector..."

# Create PID file
echo $$ > ../var/run/wazuh-modulesd.pid

# Mock module behavior
while true; do
    echo "[$(date)] wazuh-modulesd: Running vulnerability scan..."
    echo "[$(date)] wazuh-modulesd: Collecting system inventory..."
    
    # Check for network scanning activity
    if pgrep -f "nmap\|masscan\|zmap" >/dev/null 2>&1; then
        echo "[$(date)] wazuh-modulesd: VULNERABILITY ALERT - Network scanner detected"
        echo "[$(date)] wazuh-modulesd: Potential security scanning in progress"
    fi
    
    sleep 60
done
